flows:
  replace_card:
    description: the user needs to replace their card
    name: replace a card
    nlu_trigger:
      - intent:
          name: replace_card
          confidence_threshold: 0.9
    steps:
      - id: check_eligibility
        noop: true
        next:
          - if: slots.current_card_replacement_eligibility = 'not_eligible_child'
            then:
              - action: utter_ineligible_child_card
                next: END
          - else: confirm_correct_card
              
      - id: confirm_correct_card
        collect: confirm_correct_card
        next:
          - if: slots.confirm_correct_card
            then: 
              - call: replace_eligible_card
                next: END   
          - else:
              - noop:
                next:
                - if: slots.num_cards = 1
                  then:
                  - action: utter_relevant_card_not_linked
                    next: END
                - else:
                  - call: select_card
                    next: replace_eligible_card
      - id: replace_eligible_card
        call: replace_eligible_card
        next: END
     