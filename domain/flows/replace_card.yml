version: "3.1"

intents:
  - replace_card

slots:
  current_card_name:
    type: text
    shared_for_coexistence: True
  current_card_number:
    type: text
    shared_for_coexistence: True
  current_card_replacement_eligibility:
    type: text
    shared_for_coexistence: True
  num_cards:
    type: text
    shared_for_coexistence: True
  cards:
    type: list
    shared_for_coexistence: True
  confirm_correct_card:
    type: bool
    mappings:
      - type: from_llm
  replacement_reason:
    type: categorical
    values:
      - lost
      - damaged
      - never_received
      - stolen
    mappings: 
    - type: from_llm
  replace_card_eligibility:
    type: categorical
    values:
      - is_eligible
      - no_card_on_file
      - not_eligible_child
      - other
    mappings: 
    - type: from_llm
  was_card_used_fraudulently:
    type: bool
    mappings:
      - type: from_llm

responses:
  utter_ask_confirm_correct_card:
    - text: The number on file for {current_card_name} is {current_card_number}. Is this the card you want to replace?
      channel: twilio_media_streams
    - text: The number on file for {current_card_name} is {current_card_number}. Is this the card you want to replace?
      buttons:
        - payload: yes
          title: "Yes"
        - payload: no
          title: "No"
  utter_relevant_card_not_linked:
    - text: Sorry, I can't seem to find that card on file.
  utter_ask_replacement_reason:
    - text: Why do you need to replace this card?
      channel: twilio_media_streams
    - text: Why do you need to replace this card?
      buttons:
      - title: "Lost"
        payload: "lost"
      - title: "Damaged"
        payload: "damaged"
      - title: "Never Received"
        payload: "never_received"
      - title: "Stolen"
        payload: "stolen"
  utter_ask_was_card_used_fraudulently:
    - text: Do you think someone else might have used your card?
      channel: twilio_media_streams
    - text: Do you think someone else might have used your card?
      buttons:
        - payload: yes
          title: "Yes"
        - payload: no
          title: "No"
  utter_will_cancel_and_send_new:
    - text: Alright, I'll disable this card and send you a new one.
  utter_new_card_has_been_ordered:
    - text: You should get your new card within 5 business days in a plain white envelope. 
  utter_report_fraud:
    - text: I'm sorry, but I can't handle fraud here. You'll need to report this at FinX.com/disputes to get help.
  utter_unknown_replacement_reason_handover:
    - text: To help you with your card raplacement, let me connect you to an agent.
  utter_failed_handoff:
    - text: Sorry about this, but I can't reach an agent right now. I made a request and someone will contact you soon, though.
  utter_ineligible_child_card:
    - text: You'll need a legal guardian to replace your card. Let me know if you need help with something else, though! 

actions:
  - action_replace_card_eligibility
